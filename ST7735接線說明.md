# ST7735 TFT LCD 接線說明

## 📌 根據 FirmwareSpec.md 規格

規格定義：**SPI (D18, D19, D10, D8, D9, VCC, GND, D6)**

---

## 🔌 完整接線對照表（軟體 SPI 配置）

| 腳位順序 | TFT 模組標示 | Arduino UNO 接腳 | 功能說明 |
|---------|-------------|-----------------|---------|
| **1** | SDA / MOSI / DIN | **A4** | SPI 資料線（軟體 SPI）✅ |
| **2** | SCL / SCK / CLK | **A5** | SPI 時鐘線（軟體 SPI）✅ |
| **3** | CS / SS | **D10** | 晶片選擇（片選）|
| **4** | DC / A0 / RS | **D8** | 資料/命令選擇 |
| **5** | RST / RESET | **D9** | 硬體重置 |
| **6** | VCC / VDD | **5V** | 電源正極（3.3V-5V）|
| **7** | GND | **GND** | 電源負極（接地）|
| **8** | LED / BL / BLK | **D6** | 背光控制（可選）|

> 📝 **軟體 SPI 配置**：SDA=A4, SCL=A5, CS=D10, DC=D8, RST=D9

---

## ⚠️ 重要說明

### 1. 軟體 SPI 模式

本專案使用 **軟體 SPI** 模式，可以自訂 MOSI 和 SCK 腳位：

- **SDA (MOSI)** → **A4** ✅ 軟體 SPI 資料線
- **SCL (SCK)** → **A5** ✅ 軟體 SPI 時鐘線

**優點：**
- 可使用任意數位腳位
- 不佔用硬體 SPI（D11/D13）
- 方便與其他 SPI 設備共存

**缺點：**
- 速度較硬體 SPI 慢（但 TFT 顯示足夠）

### 2. 硬體 SPI vs 軟體 SPI

| 模式 | MOSI | SCK | 速度 | 說明 |
|------|------|-----|------|------|
| **軟體 SPI** | A4 | A5 | 較慢 | 本專案使用 ✅ |
| 硬體 SPI (UNO) | D11 | D13 | 較快 | 標準配置 |
| 硬體 SPI (Mega) | D51 | D52 | 較快 | Mega 2560 |

### 3. TFT 模組的標示差異

不同廠商的 TFT 模組可能使用不同的腳位標示：

| 功能 | 可能的標示 |
|------|-----------|
| 資料線 | SDA / MOSI / DIN / SI |
| 時鐘線 | SCK / SCLK / CLK |
| 片選 | CS / SS / CE |
| 資料/命令 | DC / A0 / RS |
| 重置 | RST / RESET / RES |
| 背光 | LED / BL / BLK |

---

## 🎨 視覺化接線圖（軟體 SPI 模式）

```
Arduino UNO                    ST7735 TFT LCD
============                   ==============

A4 (MOSI)  ----[1]---→ SDA     (資料線) ✅ 軟體 SPI
A5 (SCK)   ----[2]---→ SCL     (時鐘線) ✅ 軟體 SPI
D10        ----[3]---→ CS      (片選)
D8         ----[4]---→ DC      (資料/命令)
D9         ----[5]---→ RST     (重置)
5V         ----[6]---→ VCC     (電源)
GND        ----[7]---→ GND     (接地)
D6         ----[8]---→ LED     (背光)

註：[數字] 表示腳位順序
軟體 SPI：SDA=A4, SCL=A5, CS=D10, DC=D8, RST=D9
```

---

## 🔧 程式碼中的腳位定義

```cpp
// TFT LCD 腳位定義（軟體 SPI 配置）
#define TFT_CS   10       // Chip Select（D10）
#define TFT_DC   8        // Data/Command（D8）
#define TFT_RST  9        // Reset（D9）
#define TFT_MOSI A4       // SDA (MOSI) - 軟體 SPI ✅
#define TFT_SCLK A5       // SCL (SCK) - 軟體 SPI ✅
#define TFT_BL   6        // Backlight（D6）

// 初始化 TFT (軟體 SPI)：
Adafruit_ST7735 tft = Adafruit_ST7735(TFT_CS, TFT_DC, TFT_MOSI, TFT_SCLK, TFT_RST);
```

---

## 📸 實際接線照片檢查清單

根據您提供的照片，請檢查：

### ✅ 必須連接的 8 條線（軟體 SPI 配置）：
1. [ ] SDA/MOSI 連接到 **A4** ✅
2. [ ] SCL/SCK 連接到 **A5** ✅
3. [ ] CS 連接到 D10
4. [ ] DC 連接到 D8
5. [ ] RST 連接到 D9
6. [ ] VCC 連接到 5V
7. [ ] GND 連接到 GND
8. [ ] LED/BL 連接到 D6

### ⚠️ 常見錯誤：
- [ ] SDA 連接錯誤（必須是 **A4**，不是 D11）
- [ ] SCL 連接錯誤（必須是 **A5**，不是 D13）
- [ ] CS、DC、RST 腳位接錯（應該是 CS=D10, DC=D8, RST=D9）
- [ ] 電源電壓不足（需要穩定的 5V）
- [ ] 杜邦線接觸不良

---

## 🧪 接線測試程式

使用以下程式測試接線是否正確：

```cpp
#include <Adafruit_GFX.h>
#include <Adafruit_ST7735.h>

#define TFT_CS   10  // Chip Select
#define TFT_DC   8   // Data/Command
#define TFT_RST  9   // Reset
#define TFT_MOSI A4  // SDA (MOSI) - 軟體 SPI ✅
#define TFT_SCLK A5  // SCL (SCK) - 軟體 SPI ✅
#define TFT_BL   6   // Backlight

// 軟體 SPI 模式：Adafruit_ST7735(CS, DC, MOSI, SCLK, RST)
Adafruit_ST7735 tft = Adafruit_ST7735(TFT_CS, TFT_DC, TFT_MOSI, TFT_SCLK, TFT_RST);

void setup() {
  Serial.begin(9600);
  Serial.println("TFT Connection Test");
  
  // 開啟背光
  pinMode(TFT_BL, OUTPUT);
  digitalWrite(TFT_BL, HIGH);
  
  // 初始化 TFT
  tft.initR(INITR_BLACKTAB);  // 或嘗試 INITR_GREENTAB
  Serial.println("TFT Initialized");
  
  // 測試純色填充
  Serial.println("Testing RED...");
  tft.fillScreen(ST77XX_RED);
  delay(1000);
  
  Serial.println("Testing GREEN...");
  tft.fillScreen(ST77XX_GREEN);
  delay(1000);
  
  Serial.println("Testing BLUE...");
  tft.fillScreen(ST77XX_BLUE);
  delay(1000);
  
  // 測試文字顯示
  tft.fillScreen(ST77XX_BLACK);
  tft.setTextColor(ST77XX_WHITE);
  tft.setTextSize(2);
  tft.setCursor(10, 10);
  tft.println("TFT OK!");
  
  Serial.println("Test Complete");
}

void loop() {
  // 循環顯示顏色
  static uint8_t color = 0;
  switch(color) {
    case 0: tft.fillScreen(ST77XX_RED); break;
    case 1: tft.fillScreen(ST77XX_GREEN); break;
    case 2: tft.fillScreen(ST77XX_BLUE); break;
  }
  color = (color + 1) % 3;
  delay(1000);
}
```

---

## 📊 電壓與電流需求

| 項目 | 規格 | 備註 |
|------|------|------|
| **工作電壓** | 3.3V - 5V | 本專案使用 5V |
| **邏輯電壓** | 3.3V / 5V 相容 | Arduino UNO 為 5V |
| **工作電流** | 20-100mA | 含背光約 80-100mA |
| **背光電流** | 20-50mA | D6 可直接驅動 |
| **峰值電流** | 150mA | 全白畫面時 |

---

## 🔍 故障排除步驟

### 步驟 1：檢查電源
```cpp
// 在 setup() 中添加
pinMode(TFT_BL, OUTPUT);
digitalWrite(TFT_BL, HIGH);
Serial.println("Backlight ON");
```
**預期結果**：TFT 背光應該亮起（可能是白屏）

### 步驟 2：檢查 SPI 通訊
```cpp
// 測試 CS 腳位
pinMode(TFT_CS, OUTPUT);
digitalWrite(TFT_CS, LOW);
Serial.print("CS = ");
Serial.println(digitalRead(TFT_CS));  // 應該是 0
```

### 步驟 3：測試初始化
```cpp
tft.initR(INITR_BLACKTAB);
delay(500);
tft.fillScreen(ST77XX_RED);
Serial.println("RED screen");
```
**預期結果**：螢幕應該變紅色

### 步驟 4：如果步驟 3 失敗
嘗試不同的初始化類型：
```cpp
// tft.initR(INITR_BLACKTAB);   // 黑色標籤
tft.initR(INITR_GREENTAB);   // 綠色標籤（試試這個）
// tft.initR(INITR_REDTAB);     // 紅色標籤
// tft.initR(INITR_144GREENTAB); // 1.44" 版本
```

---

## 📝 軟體 SPI 配置對照表

| 功能 | Arduino 腳位 | TFT 模組標示 | 備註 |
|------|-------------|-------------|------|
| MOSI | **A4** | SDA / DIN | SPI 資料線（軟體 SPI）✅ |
| SCK | **A5** | SCL / CLK | SPI 時鐘線（軟體 SPI）✅ |
| CS | D10 | CS / SS | 晶片選擇 |
| DC | D8 | DC / A0 / RS | 資料/命令 |
| RST | D9 | RST / RESET | 重置 |
| VCC | 5V | VCC / VDD | 電源 |
| GND | GND | GND | 接地 |
| BL | D6 | LED / BL | 背光 |

> 📝 **軟體 SPI 配置**：SDA=A4, SCL=A5, CS=D10, DC=D8, RST=D9

---

## ✅ 檢查完成確認

當接線完全正確時，您應該看到：

1. ✅ 背光亮起（白色或有顏色的畫面）
2. ✅ 能顯示不同顏色（紅、綠、藍）
3. ✅ 能顯示文字和圖形
4. ✅ 畫面清晰無閃爍
5. ✅ 序列埠無錯誤訊息

---

**文件版本**：v2.0（軟體 SPI）  
**最後更新**：2025/11/10  
**對應規格**：FirmwareSpec.md v1.0  
**測試平台**：Arduino UNO + ST7735 1.8" TFT LCD  
**重要變更**：改用軟體 SPI，SDA=A4, SCL=A5
